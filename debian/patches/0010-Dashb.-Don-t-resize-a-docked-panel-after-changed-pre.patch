From 1818b95f66b4dbf9147acbb3cd013c081a1b2df7 Mon Sep 17 00:00:00 2001
From: Hakan <momo@stupan.se>
Date: Wed, 27 Aug 2025 08:27:52 +0200
Subject: [PATCH] Dashb. Don't resize a docked panel after changed prefs. #4638

Applied-upstream: https://github.com/OpenCPN/OpenCPN/commit/1818b95f6

---
 plugins/dashboard_pi/src/dashboard_pi.cpp | 15 +++++++++++----
 1 file changed, 11 insertions(+), 4 deletions(-)

diff --git a/plugins/dashboard_pi/src/dashboard_pi.cpp b/plugins/dashboard_pi/src/dashboard_pi.cpp
index f24d1c7f0..b84f858bd 100644
--- a/plugins/dashboard_pi/src/dashboard_pi.cpp
+++ b/plugins/dashboard_pi/src/dashboard_pi.cpp
@@ -5777,12 +5777,19 @@ void DashboardWindow::OnContextMenuSelect(wxCommandEvent &event) {
 
   switch (event.GetId()) {
     case ID_DASH_PREFS: {
+      wxAuiPaneInfo &pane = m_pauimgr->GetPane(this);
       // Capture the dashboard's floating_pos before update.
-      wxPoint fp = m_pauimgr->GetPane(this).floating_pos;
+      wxPoint fp = pane.floating_pos;
       m_plugin->ShowPreferencesDialog(this);
-      // This method sets the correct size of the edited dashboard,
-      // but if it's not specified, also a default floating_pos.
-      ChangePaneOrientation(GetSizerOrientation(), true, fp.x, fp.y);
+
+      /*
+      This function sets the correct size of the edited dashboard with the
+      previous floating position instead of the default that is otherwise used.
+      If the panel is docked the size is instead specified by the docking logic
+       */
+      if (!pane.IsDocked())
+        ChangePaneOrientation(GetSizerOrientation(), true, fp.x, fp.y);
+
       if (g_bUseInternSumLog) m_plugin->UpdateSumLog(false);
       return;  // Does it's own save.
     }
-- 
2.50.0

